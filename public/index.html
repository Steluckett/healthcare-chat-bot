<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fresh Jobs Chat - Cygnet Group Careers</title>
    
    <!-- External Dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Figtree:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Local Styles - Try different paths -->
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Fallback inline styles in case CSS doesn't load -->
    <style>
        /* Emergency fallback styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Figtree', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .chat-container {
            min-height: 100vh;
            position: relative;
            background: transparent;
        }
        
        .messages-container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 2rem 1.5rem 10rem;
        }
        
        .messages-list {
            display: flex;
            flex-direction: column;
            gap: 3rem;
        }
        
        .message-wrapper {
            display: flex;
        }
        
        .message-wrapper.user {
            justify-content: flex-end;
        }
        
        .message-wrapper.ai {
            justify-content: flex-start;
        }
        
        .message-wrapper.initial {
            padding-top: 10rem;
        }
        
        .message-content {
            max-width: 64rem;
            order: 1;
        }
        
        .message-content.user {
            order: 2;
        }
        
        .message-layout {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .message-layout.user {
            flex-direction: row-reverse;
        }
        
        .avatar {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .avatar.ai {
            background: linear-gradient(to right, #005994, #BFD12F);
        }
        
        .avatar.user {
            background: #d1d5db;
        }
        
        .avatar-icon {
            width: 1.5rem;
            height: 1.5rem;
            color: white;
        }
        
        .avatar-icon.user {
            color: #4b5563;
        }
        
        .message-bubble {
            flex: 1;
            display: inline-block;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .message-bubble.user {
            background: rgb(0, 89, 148);
            color: white;
            padding: 1.5rem;
            text-align: right;
        }
        
        .message-bubble.ai {
            background: rgba(255, 255, 255, 0.9);
            color: #1f2937;
            border: 1px solid rgba(229, 231, 235, 0.5);
            padding: 2.5rem;
            text-align: left;
        }
        
        .message-text {
            white-space: pre-wrap;
            line-height: 1.6;
            font-weight: 300;
            font-size: 1rem;
        }
        
        .quick-actions {
            margin-top: 2rem;
        }
        
        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .quick-action-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #e5e7eb;
            border-radius: 1.5rem;
            padding: 1.5rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .quick-action-btn:hover {
            background: white;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .quick-action-content {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .quick-action-title {
            color: #111827;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .quick-action-description {
            color: #4b5563;
            font-size: 0.875rem;
            font-weight: 300;
        }
        
        .job-cards-container {
            margin-top: 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .job-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 1.5rem;
            padding: 1.5rem;
            border: 1px solid rgba(229, 231, 235, 0.5);
            transition: all 0.3s ease;
        }
        
        .job-card:hover {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .job-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .job-card-category {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: rgba(219, 234, 254, 0.8);
            color: #1d4ed8;
            font-size: 0.875rem;
            border-radius: 1.5rem;
            font-weight: 400;
        }
        
        .job-card-title {
            color: #111827;
            margin-bottom: 0.75rem;
            font-size: 1rem;
            line-height: 1.3;
            font-weight: 500;
        }
        
        .job-card-description {
            color: #4b5563;
            font-size: 0.875rem;
            margin-bottom: 1rem;
            font-weight: 300;
        }
        
        .job-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .job-card-salary {
            color: #111827;
            font-size: 1rem;
            font-weight: 500;
        }
        
        .job-card-view-btn {
            background: linear-gradient(to right, #005994, #BFD12F);
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: 1rem;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 400;
        }
        
        .input-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding-top: 2rem;
        }
        
        .input-wrapper {
            max-width: 80rem;
            margin: 0 auto;
            padding: 0 1.5rem 2rem;
        }
        
        .input-relative {
            position: relative;
        }
        
        .input-textarea {
            width: 100%;
            resize: none;
            border: 0;
            border-radius: 9999px;
            padding: 2rem 2.5rem;
            padding-right: 8rem;
            outline: none;
            background: white;
            color: #374151;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            font-size: 1.125rem;
            font-weight: 300;
            font-family: 'Figtree', sans-serif;
            min-height: 72px;
        }
        
        .send-btn {
            position: absolute;
            right: 1rem;
            top: 1.25rem;
            background: rgb(0, 89, 148);
            color: white;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .upload-btn {
            position: absolute;
            right: 5rem;
            top: 1.25rem;
            color: #6b7280;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .file-input {
            display: none;
        }
        
        /* Modal styles */
        .modal-overlay {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            z-index: 999999999 !important;
        }
        
        .modal-content {
            background: white;
            border-radius: 1.5rem;
            max-width: 48rem;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
        }
        
        .modal-inner {
            padding: 2.5rem;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 2.5rem;
        }
        
        .modal-title {
            font-size: 2.25rem;
            color: #111827;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #9ca3af;
        }
        
        .modal-apply-btn {
            width: 100%;
            background: linear-gradient(to right, #005994, #BFD12F);
            color: white;
            padding: 1.25rem 2.5rem;
            border-radius: 1.5rem;
            border: none;
            cursor: pointer;
            font-size: 1.25rem;
            font-weight: 400;
        }
    </style>
    
    <!-- Lucide Icons (Simple SVG Icons) -->
    <script>
        // Simple icon components to replace Lucide
        const iconSvgs = {
            Send: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>`,
            MapPin: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"/><circle cx="12" cy="10" r="3"/></svg>`,
            Clock: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg>`,
            Briefcase: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/><rect width="20" height="14" x="2" y="6" rx="2"/></svg>`,
            Sparkles: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.582a.5.5 0 0 1 0 .962L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"/></svg>`,
            ArrowRight: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>`,
            User: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>`,
            Upload: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7,10 12,5 17,10"/><line x1="12" x2="12" y1="5" y2="15"/></svg>`,
            FileText: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>`,
            X: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>`,
            Heart: `<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5Z"/></svg>`
        };

        // Simple icon component generator
        function createIcon(name, className = '') {
            return React.createElement('span', {
                className: className,
                dangerouslySetInnerHTML: { __html: iconSvgs[name] }
            });
        }

        // Export icons for use in React
        window.Icons = {
            Send: (props) => createIcon('Send', props.className),
            MapPin: (props) => createIcon('MapPin', props.className),
            Clock: (props) => createIcon('Clock', props.className),
            Briefcase: (props) => createIcon('Briefcase', props.className),
            Sparkles: (props) => createIcon('Sparkles', props.className),
            ArrowRight: (props) => createIcon('ArrowRight', props.className),
            User: (props) => createIcon('User', props.className),
            Upload: (props) => createIcon('Upload', props.className),
            FileText: (props) => createIcon('FileText', props.className),
            X: (props) => createIcon('X', props.className),
            Heart: (props) => createIcon('Heart', props.className)
        };
    </script>
    
    <!-- Jobs Data -->
    <script src="jobsData.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        const { Send, MapPin, Clock, Briefcase, Sparkles, ArrowRight, User, Upload, FileText, X, Heart } = window.Icons;

        const FreshJobsChat = () => {
            const [messages, setMessages] = useState([
                {
                    id: 1,
                    type: 'ai',
                    content: "Hello! I'm your AI assistant for Cygnet Group healthcare careers. I can help you discover mental health, learning disabilities, and healthcare support roles across the UK. What type of position interests you today?",
                    timestamp: new Date()
                }
            ]);
            const [inputValue, setInputValue] = useState('');
            const [jobs, setJobs] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            const [selectedJob, setSelectedJob] = useState(null);
            const [showJobModal, setShowJobModal] = useState(false);
            const [userCV, setUserCV] = useState(null);
            const [showTooltip, setShowTooltip] = useState(false);
            const messagesEndRef = useRef(null);
            const fileInputRef = useRef(null);

            // Use jobs data from external file (with fallback)
            const sampleJobs = window.jobsData || [
                {
                    id: 1,
                    title: "Mental Health Nurse",
                    company: "Cygnet Group",
                    location: "London, England",
                    salary: "£32,000 - £38,000",
                    type: "Full-time",
                    posted: "2 days ago",
                    skills: ["Mental Health Assessment", "Therapeutic Communication"],
                    description: "Join our dedicated mental health team providing compassionate care to adults with complex mental health needs.",
                    category: "Mental Health",
                    applyUrl: "https://apply.cygnetgroup.com/job/mental-health-nurse"
                }
            ];
            
            const cityCoordinates = window.cityCoordinates || {
                'london': { lat: 51.5074, lng: -0.1278 },
                'birmingham': { lat: 52.4862, lng: -1.8904 },
                'manchester': { lat: 53.4808, lng: -2.2426 }
            };

            const handleSendMessage = () => {
                if (!inputValue.trim()) return;

                const userMessage = {
                    id: Date.now(),
                    type: 'user',
                    content: inputValue,
                    timestamp: new Date()
                };

                setMessages(prev => [...prev, userMessage]);
                setInputValue('');
                setIsLoading(true);

                // Simulate AI response
                setTimeout(() => {
                    const aiMessage = {
                        id: Date.now() + 1,
                        type: 'ai',
                        content: "I'd be happy to help you explore healthcare opportunities at Cygnet Group! Here are some roles that might interest you.",
                        matchingJobs: [1],
                        timestamp: new Date()
                    };
                    setMessages(prev => [...prev, aiMessage]);
                    setIsLoading(false);
                }, 1000);
            };

            const handleJobClick = (job) => {
                setSelectedJob(job);
                setShowJobModal(true);
            };

            const closeJobModal = () => {
                setShowJobModal(false);
                setSelectedJob(null);
            };

            const handleApply = (job) => {
                window.open(job.applyUrl || 'https://apply.cygnetgroup.com/', '_blank');
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };

            useEffect(() => {
                setJobs(sampleJobs);
            }, []);

            return (
                <div className="chat-container">
                    <div className="messages-container">
                        <div className="messages-list">
                            {messages.map((message) => (
                                <div 
                                    key={message.id} 
                                    className={`message-wrapper ${message.type} ${message.id === 1 ? 'initial' : ''}`}
                                >
                                    <div className={`message-content ${message.type}`}>
                                        <div className={`message-layout ${message.type}`}>
                                            <div className={`avatar ${message.type}`}>
                                                {message.type === 'ai' ? (
                                                    <Sparkles className="avatar-icon" />
                                                ) : (
                                                    <User className="avatar-icon user" />
                                                )}
                                            </div>
                                            
                                            <div className="flex-1">
                                                <div className={`message-bubble ${message.type}`}>
                                                    <div className="message-text">
                                                        {message.content}
                                                    </div>
                                                    
                                                    {message.id === 1 && (
                                                        <div className="quick-actions">
                                                            <div className="quick-actions-grid">
                                                                <button
                                                                    onClick={() => setInputValue("I'm looking for mental health nursing roles")}
                                                                    className="quick-action-btn"
                                                                >
                                                                    <div className="quick-action-content">
                                                                        <div>
                                                                            <h4 className="quick-action-title">Mental Health Roles</h4>
                                                                            <p className="quick-action-description">
                                                                                Explore nursing and support positions
                                                                            </p>
                                                                        </div>
                                                                    </div>
                                                                </button>
                                                                
                                                                <button
                                                                    onClick={() => setInputValue("Show me support worker positions")}
                                                                    className="quick-action-btn"
                                                                >
                                                                    <div className="quick-action-content">
                                                                        <div>
                                                                            <h4 className="quick-action-title">Support Worker Roles</h4>
                                                                            <p className="quick-action-description">
                                                                                Find opportunities in learning disabilities support
                                                                            </p>
                                                                        </div>
                                                                    </div>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    )}

                                                    {message.matchingJobs && message.matchingJobs.length > 0 && (
                                                        <div className="job-cards-container">
                                                            {sampleJobs
                                                                .filter(job => message.matchingJobs.includes(job.id))
                                                                .map(job => (
                                                                    <div key={job.id} className="job-card">
                                                                        <div className="job-card-header">
                                                                            <div className="job-card-category">
                                                                                {job.category}
                                                                            </div>
                                                                        </div>
                                                                        
                                                                        <h4 className="job-card-title">{job.title}</h4>
                                                                        <p className="job-card-description">{job.description}</p>
                                                                        
                                                                        <div className="job-card-footer">
                                                                            <div className="job-card-salary">{job.salary}</div>
                                                                            <button
                                                                                onClick={() => handleJobClick(job)}
                                                                                className="job-card-view-btn"
                                                                            >
                                                                                View Details
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                ))}
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="input-container">
                        <div className="input-wrapper">
                            <div className="input-relative">
                                <textarea
                                    value={inputValue}
                                    onChange={(e) => setInputValue(e.target.value)}
                                    onKeyPress={handleKeyPress}
                                    placeholder="Ask about healthcare roles..."
                                    className="input-textarea"
                                    rows="1"
                                    disabled={isLoading}
                                />
                                
                                <input
                                    ref={fileInputRef}
                                    type="file"
                                    className="file-input"
                                />
                                
                                <button
                                    onClick={() => fileInputRef.current?.click()}
                                    className="upload-btn"
                                >
                                    <Upload className="upload-btn-icon" />
                                </button>
                                
                                <button
                                    onClick={handleSendMessage}
                                    disabled={isLoading || !inputValue.trim()}
                                    className="send-btn"
                                >
                                    <Send className="send-btn-icon" />
                                </button>
                            </div>
                        </div>
                    </div>

                    {showJobModal && selectedJob && (
                        <div className="modal-overlay">
                            <div className="modal-content">
                                <div className="modal-inner">
                                    <div className="modal-header">
                                        <div>
                                            <h2 className="modal-title">{selectedJob.title}</h2>
                                            <p>{selectedJob.company}</p>
                                        </div>
                                        <button
                                            onClick={closeJobModal}
                                            className="modal-close"
                                        >
                                            ×
                                        </button>
                                    </div>

                                    <div>
                                        <p>{selectedJob.description}</p>
                                        <p><strong>Location:</strong> {selectedJob.location}</p>
                                        <p><strong>Salary:</strong> {selectedJob.salary}</p>
                                        <p><strong>Type:</strong> {selectedJob.type}</p>
                                    </div>

                                    <div style={{marginTop: '2rem'}}>
                                        <button
                                            onClick={() => handleApply(selectedJob)}
                                            className="modal-apply-btn"
                                        >
                                            Apply Now
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<FreshJobsChat />, document.getElementById('root'));
    </script>
</body>
</html>
